<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Used BMW Car Price Predictor</title>
    <style>
        * {margin:0;padding:0;box-sizing:border-box;}
        body {font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;padding:20px;}
        .container {max-width:800px;margin:0 auto;background:white;border-radius:20px;box-shadow:0 20px 60px rgba(0,0,0,0.3);overflow:hidden;}
        .header {background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;padding:40px;text-align:center;}
        .header h1 {font-size:2.5em;margin-bottom:10px;}
        .header p {font-size:1.1em;opacity:0.9;}
        .form-container {padding:40px;}
        .form-group {margin-bottom:25px;}
        .form-group label {display:block;margin-bottom:8px;font-weight:600;color:#333;font-size:0.95em;}
        .form-group input,.form-group select {width:100%;padding:12px 15px;border:2px solid #e0e0e0;border-radius:8px;font-size:1em;transition:all 0.3s;}
        .form-group input:focus,.form-group select:focus {outline:none;border-color:#667eea;box-shadow:0 0 0 3px rgba(102,126,234,0.1);}
        .form-row {display:grid;grid-template-columns:1fr 1fr;gap:20px;}
        .btn {width:100%;padding:15px;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;border:none;border-radius:8px;font-size:1.1em;font-weight:600;cursor:pointer;transition:transform 0.2s,box-shadow 0.2s;}
        .btn:hover {transform:translateY(-2px);box-shadow:0 10px 20px rgba(102,126,234,0.3);}
        .btn:active {transform:translateY(0);}
        .result {margin-top:30px;padding:30px;background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%);border-radius:12px;color:white;text-align:center;animation:slideIn 0.5s ease-out;}
        .result h2 {font-size:1.5em;margin-bottom:15px;}
        .result .price {font-size:3em;font-weight:bold;margin:15px 0;}
        .result .confidence {font-size:1em;opacity:0.9;margin-top:10px;}
        .error {margin-top:20px;padding:20px;background:#f44336;color:white;border-radius:8px;text-align:center;}
        @keyframes slideIn {from {opacity:0;transform:translateY(20px);} to {opacity:1;transform:translateY(0);}}
        .info-box {background:#e3f2fd;border-left:4px solid #2196F3;padding:15px;margin-bottom:30px;border-radius:4px;}
        .info-box p {color:#1976D2;margin:0;}
        @media(max-width:768px){.form-row{grid-template-columns:1fr;}.header h1{font-size:2em;}.result .price{font-size:2.5em;}}
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöó BMW Car Price Predictor</h1>
            <p>Get instant price estimates for used BMW vehicles</p>
        </div>

        <div class="form-container">
            <div class="info-box">
                <p>üìä Powered by optimized Random Forest model with 94.5% of variances capture in price</p>
            </div>

            <!-- Form starts -->
            <form action="/predict" method="POST">
                <div class="form-row">
                    <div class="form-group">
                        <label for="model">BMW Model *</label>
                        <select id="model" name="model" required>
                            <option value="">Select Model</option>
                            {% for m in [' 1 Series',' 2 Series',' 3 Series',' 4 Series',' 5 Series',' 6 Series',' 7 Series',' 8 Series',' X1',' X2',' X3',' X4',' X5',' X6',' X7',' Z3',' Z4',' i3',' i8',' M2',' M3',' M4',' M5',' M6'] %}
                                <option value="{{ m }}" {% if input_data and input_data.model == m %}selected{% endif %}>{{ m.strip() }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="year">Year *</label>
                        <input type="number" id="year" name="year" min="1996" max="2026" placeholder="e.g., 2019" required
                               value="{{ input_data.year if input_data else '' }}">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="transmission">Transmission *</label>
                        <select id="transmission" name="transmission" required>
                            <option value="">Select Transmission</option>
                            {% for t in ['Manual','Automatic','Semi-Auto'] %}
                                <option value="{{ t }}" {% if input_data and input_data.transmission == t %}selected{% endif %}>{{ t }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="mileage">Mileage (miles) *</label>
                        <input type="number" id="mileage" name="mileage" min="0" placeholder="e.g., 15000" required
                               value="{{ input_data.mileage if input_data else '' }}">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="fuelType">Fuel Type *</label>
                        <select id="fuelType" name="fuelType" required>
                            <option value="">Select Fuel Type</option>
                            {% for f in ['Diesel','Petrol','Hybrid','Electric','Other'] %}
                                <option value="{{ f }}" {% if input_data and input_data.fuelType == f %}selected{% endif %}>{{ f }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="tax">Road Tax (¬£) *</label>
                        <input type="number" id="tax" name="tax" min="0" placeholder="e.g., 145" required
                               value="{{ input_data.tax if input_data else '' }}">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="mpg">MPG (Miles Per Gallon) *</label>
                        <input type="number" id="mpg" name="mpg" step="0.1" min="0" placeholder="e.g., 65.7" required
                               value="{{ input_data.mpg if input_data else '' }}">
                    </div>
                    <div class="form-group">
                        <label for="engineSize">Engine Size (L) *</label>
                        <input type="number" id="engineSize" name="engineSize" step="0.1" min="0" placeholder="e.g., 2.0" required
                               value="{{ input_data.engineSize if input_data else '' }}">
                    </div>
                </div>

                <button type="submit" class="btn">üîÆ Predict Price</button>
            </form>
            <!-- Form ends -->

            {% if prediction_formatted %}
            <div class="result">
                <h2>üí∞ Estimated Price</h2>
                <div class="price">{{ prediction_formatted }}</div>
                <div class="confidence">
                    Confidence Range: {{ lower_bound_formatted }} - {{ upper_bound_formatted }}
                </div>
                <p style="margin-top: 15px; font-size: 0.9em;">
                    Based on {{ input_data.model }} ({{ input_data.year }}) with {{ input_data.mileage }} miles
                </p>
            </div>
            {% endif %}

            {% if error %}
            <div class="error">
                <strong>‚ö†Ô∏è Error:</strong> {{ error }}
            </div>
            {% endif %}

        </div>
    </div>

    <script>
        document.querySelectorAll('input, select').forEach(el => {
            el.addEventListener('focus', function(){ this.parentElement.style.transform='scale(1.02)'; this.parentElement.style.transition='transform 0.2s'; });
            el.addEventListener('blur', function(){ this.parentElement.style.transform='scale(1)'; });
        });
        document.querySelector('form').addEventListener('submit', function(e){
            const year=parseInt(document.getElementById('year').value);
            const currentYear=new Date().getFullYear();
            if(year>currentYear){e.preventDefault();alert('Year cannot be in the future!');return false;}
        });
    </script>
</body>
</html>
